<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>편지</title>

<!-- 화면 캡처용 라이브러리 -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<!-- 폰트 -->
<link href="https://fonts.googleapis.com/css2?family=Nanum+Pen+Script&display=swap" rel="stylesheet">

<style>
body {
    margin: 0;
    padding: 0;
    background: #465d46;
    overflow: hidden;
    font-family: 'Nanum Pen Script', cursive;
}

/* 전체 영역 */
#scene {
    position: relative;
    width: 100vw;
    height: 100vh;
}

/* 알 이미지 */
#egg {
    position: absolute;
    left: 20px;
    bottom: 20px;
    width: 250px;
    cursor: pointer;
}

/* 편지1 컨테이너 */
#letter1-container {
    position: absolute;
    left: 300px;
    top: 15%;
    width: 600px;
    display: none;
}

#letter1 {
    width: 100%;
}

/* 편지1 텍스트 (미리 작성) */
#letter1-text {
    position: absolute;
    top: 25%;
    left: 10%;
    width: 80%;
    font-size: 24px;
    line-height: 1.5;
    white-space: pre-line;
    color: #333;
    pointer-events: none;
}

/* 편지2 */
#letter2-container {
    position: absolute;
    right: 200px;
    top: 50%;
    transform: translateY(-50%);
    width: 600px;
}

#letter2 {
    width: 100%;
}

/* 텍스트 입력 박스 */
#textBox {
    position: absolute;
    top: 11%;
    bottom: 6%;
    left: 10%;
    width: 80%;

    resize: none;
    border: none;
    background: transparent;

    font-size: 26px;
    line-height: 1.6;
    outline: none;

    font-family: 'Nanum Pen Script', cursive;
    color: #333;
}


/* 버튼 영역 */
#buttons {
    position: absolute;
    top: 10px;
    right: 10px;
    display: flex;
    gap: 10px;
}

button {
    padding: 8px 12px;
    border: none;
    border-radius: 6px;
    background: #333;
    color: white;
    cursor: pointer;
}
</style>
</head>

<body>
<div id="scene">

    <!-- 알 -->
    <img id="egg" src="알.png">

    <!-- 편지1 (미리 작성된 편지) -->
    <div id="letter1-container">
        <img id="letter1" src="편지1.png">
        <div id="letter1-text">
알을 열기 전부터
전해주고 싶었던 말이 있어요.

이 편지는
처음부터 당신을 위해 준비된
이야기입니다.
        </div>
    </div>

    <!-- 편지2 (사용자 입력) -->
    <div id="letter2-container">
        <img id="letter2" src="편지2.png">
        <textarea id="textBox" placeholder="여기에 글을 입력하세요"></textarea>
    </div>

    <!-- 버튼 -->
    <div id="buttons">
        <button onclick="saveText()">저장</button>
        <button onclick="saveImage()">이미지 저장</button>
    </div>

</div>

<script>
let eggOpen = false;

const egg = document.getElementById("egg");
const letter1Container = document.getElementById("letter1-container");
const textBox = document.getElementById("textBox");

/* 알 클릭 */
egg.addEventListener("click", () => {
    eggOpen = !eggOpen;
    egg.src = eggOpen ? "알2.png" : "알.png";
    letter1Container.style.display = eggOpen ? "block" : "none";
});

/* 텍스트 저장 */
function saveText() {
    localStorage.setItem("letterText", textBox.value);
    alert("텍스트가 저장되었습니다!");
}

/* 저장된 텍스트 불러오기 */
window.onload = () => {
    const saved = localStorage.getItem("letterText");
    if (saved) textBox.value = saved;
};

/* 화면 이미지 저장 */
function saveImage() {
    html2canvas(document.getElementById("scene")).then(canvas => {
        const link = document.createElement("a");
        link.download = "편지.png";
        link.href = canvas.toDataURL();
        link.click();
    });
}
</script>
</body>
</html>
