<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>편지</title>

<!-- html 캡처 -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<!-- 가람연꽃 폰트 -->
<style>
@font-face {
    font-family: 'GaramYeonkkot';
    src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/noonfonts_2107@1.1/GaramYeonkkot.woff2') format('woff2');
    font-weight: normal;
    font-display: swap;
}

body {
    margin: 0;
    background: #465d46;
    overflow: hidden;
    font-family: 'GaramYeonkkot', serif;
}

/* 전체 영역 */
#scene {
    position: relative;
    width: 100vw;
    height: 100vh;
}

/* 눈 효과 */
.snow {
    position: absolute;
    top: -10px;
    width: 100%;
    height: 100%;
    pointer-events: none;
    background-image:
        radial-gradient(2px 2px at 20px 30px, white 100%, transparent 0),
        radial-gradient(2px 2px at 80px 90px, white 100%, transparent 0),
        radial-gradient(1.5px 1.5px at 150px 60px, white 100%, transparent 0);
    background-size: 200px 200px;
    animation: snowFall 12s linear infinite;
}

@keyframes snowFall {
    from { background-position: 0 -200px; }
    to { background-position: 0 800px; }
}

/* 알 */
#egg {
    position: absolute;
    left: 20px;
    bottom: 20px;
    width: 250px;
    cursor: pointer;
}

/* 편지1 */
#letter1-container {
    position: absolute;
    left: 300px;
    top: 15%;
    width: 600px;
    opacity: 0;
    transform: translateY(30px);
    transition: all 0.8s ease;
    display: none;
}

#letter1-container.show {
    opacity: 1;
    transform: translateY(0);
}

#letter1 {
    width: 100%;
    filter: drop-shadow(0 0 12px rgba(255,255,200,0.4));
}

#letter1-text {
    position: absolute;
    top: 25%;
    left: 10%;
    width: 80%;
    font-size: 25px;
    line-height: 1.7;
    white-space: pre-line;
    color: #333;
    pointer-events: none;
}

/* 편지2 */
#letter2-container {
    position: absolute;
    right: 200px;
    top: 50%;
    transform: translateY(-50%);
    width: 600px;
}

#letter2 {
    width: 100%;
    filter: drop-shadow(0 0 12px rgba(255,255,200,0.4));
}


/* 텍스트 박스 */
#textBox {
    position: absolute;
    top: 11%;
    bottom: 6%;
    left: 10%;
    width: 80%;
    resize: none;
    border: none;
    background: transparent;
    font-family: 'GaramYeonkkot', serif;
    font-size: 26px;
    line-height: 1.7;
    outline: none;
    color: #333;
    overflow: hidden;
}

/* 버튼 */
#buttons {
    position: absolute;
    top: 10px;
    right: 10px;
    display: flex;
    gap: 10px;
}

button {
    padding: 8px 14px;
    border: none;
    border-radius: 6px;
    background: #8b2f2f;
    color: white;
    font-family: 'GaramYeonkkot', serif;
    cursor: pointer;
    box-shadow: 0 0 8px rgba(255,80,80,0.6);
}
</style>
</head>

<body>
<div id="scene">
    <div class="snow"></div>

    <!-- 알 -->
    <img id="egg" src="알.png">

    <!-- 편지1 -->
    <div id="letter1-container">
        <img id="letter1" src="편지1.png">
        <div id="letter1-text">
메리크리스마스!!

행복한 새해 되길 바랄게.
        </div>
    </div>

    <!-- 편지2 -->
    <div id="letter2-container">
        <img id="letter2" src="편지2.png">
        <textarea id="textBox" placeholder="여기에 글을 입력하세요"></textarea>
    </div>

    <!-- 버튼 -->
    <div id="buttons">
        <button onclick="saveText()">저장</button>
        <button onclick="saveImage()">이미지 저장</button>
    </div>
</div>

<script>
let eggOpen = false;

const egg = document.getElementById("egg");
const letter1Container = document.getElementById("letter1-container");
const textBox = document.getElementById("textBox");

/* 알 클릭 */
egg.addEventListener("click", () => {
    eggOpen = !eggOpen;
    egg.src = eggOpen ? "알2.png" : "알.png";

    if (eggOpen) {
        letter1Container.style.display = "block";
        setTimeout(() => letter1Container.classList.add("show"), 10);
    } else {
        letter1Container.classList.remove("show");
        setTimeout(() => letter1Container.style.display = "none", 800);
    }
});

/* 텍스트 자동 높이 */
textBox.addEventListener("input", () => {
    textBox.style.height = "auto";
    textBox.style.height = textBox.scrollHeight + "px";
});

/* 텍스트 저장 */
function saveText() {
    localStorage.setItem("letterText", textBox.value);
    alert("텍스트가 저장되었습니다!");
}

/* 불러오기 */
window.onload = () => {
    const saved = localStorage.getItem("letterText");
    if (saved) textBox.value = saved;
};

/* 이미지 저장 */
function saveImage() {
    html2canvas(document.getElementById("scene")).then(canvas => {
        const link = document.createElement("a");
        link.download = "편지.png";
        link.href = canvas.toDataURL();
        link.click();
    });
}
</script>
</body>
</html>
